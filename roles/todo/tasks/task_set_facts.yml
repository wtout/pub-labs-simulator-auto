---
- name: define capcheck
  set_fact:
    capcheck: true
  when:
    - deploy | default(false) | bool
    - "'vcenter' in group_names or (build.disaster_recovery and 'drvcenter' in group_names)"
  tags: [ 'capcheck', 'vm_creation' ]
  
- name: define create_vms_iso
  set_fact:
    create_vms_iso: true
  when:
    - deploy | default(false) | bool
    - "'stack' in group_names or (build.disaster_recovery and 'dr' in group_names)"
  tags: vm_creation

- name: define rollback_vms_iso
  set_fact:
    rollback_vms_iso: true
  when:
    - rollback | default(false) | bool
    - "'stack' in group_names or (build.disaster_recovery and 'dr' in group_names)"
  tags: vm_creation

- name: define harden_vms
  set_fact:
    harden_vms: true
  when:
    - deploy | default(false) | bool
    - "'stack' in group_names or (build.disaster_recovery and 'dr' in group_names)"
  tags: vm_hardening

- name: define configure_vms_iso
  set_fact:
    configure_vms_iso: true
  when:
    - deploy | default(false) | bool
    - "'stack' in group_names or (build.disaster_recovery and 'dr' in group_names)"
  tags: [ 'vm_configuration' ]

- name: define deploy_devsim
  set_fact:
    deploy_devsim: true
  when:
    - deploy | default(false) | bool
    - "'stack' in group_names or (build.disaster_recovery and 'dr' in group_names)"
  tags: [ 'never', 'devsim' ]

- name: define start_devsim
  set_fact:
    start_devsim: true
  when:
    - start | default(false) | bool
    - "'stack' in group_names or (build.disaster_recovery and 'dr' in group_names)"
  tags: [ 'never', 'devsim' ]

- name: define stop_devsim
  set_fact:
    stop_devsim: true
  when:
    - stop | default(false) | bool
    - "'stack' in group_names or (build.disaster_recovery and 'dr' in group_names)"
  tags: [ 'never', 'devsim' ]

- name: define rollback_devsim
  set_fact:
    rollback_devsim: true
  when:
    - rollback | default(false) | bool
    - "'stack' in group_names or (build.disaster_recovery and 'dr' in group_names)"
  tags: [ 'never', 'devsim' ]

- name: define check_devsim
  set_fact:
    check_devsim: true
  when:
    - check | default(false) | bool
    - "'stack' in group_names or (build.disaster_recovery and 'dr' in group_names)"
  tags: [ 'never', 'devsim' ]

#- name: define check_requiretty
#  set_fact:
#    check_requiretty: true
#  when:
#    - deploy | default(false) | bool
#    - inventory_hostname in groups['stack'] or ('dr' in group_names and build.disaster_recovery)
#  tags: check_requiretty
